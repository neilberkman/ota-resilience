schema_version: 1
name: mcuboot_head_upgrade
description: >
  MCUboot HEAD swap-using-move upgrade (TEST swap) scenario.
  Secondary has new image with magic GOOD â€” triggers BOOT_SWAP_TYPE_TEST.
  MCUboot swaps secondary into primary. Tests power-loss resilience
  during the forward upgrade path.

platform: platforms/cortex_m4_flash_fast.repl
bootloader:
  elf: results/oss_validation/assets/oss_mcuboot_head.elf
  entry: 0x00000000
memory:
  sram: { start: 0x20000000, end: 0x20040000 }
  write_granularity: 4
  slots:
    exec: { base: 0x0000C000, size: 0x76000 }
    staging: { base: 0x00082000, size: 0x76000 }
# Upgrade scenario: new image in secondary, trigger swap.
images:
  exec: results/oss_validation/assets/zephyr_slot0_padded.bin
  staging: results/oss_validation/assets/zephyr_slot1_padded.bin
# Secondary trailer triggers TEST swap.
update_trigger:
  type: mcuboot_trailer_magic
  slot: staging
success_criteria:
  vtor_in_slot: exec
  # After upgrade, exec slot should have the staging image.
  image_hash: true
  expected_image: staging
fault_sweep:
  mode: runtime
  evaluation_mode: execute
  max_writes: auto
  max_writes_cap: 200000
  run_duration: "2.0"
  max_step_limit: 20000000
expect:
  should_find_issues: false
