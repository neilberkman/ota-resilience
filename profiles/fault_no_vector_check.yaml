schema_version: 1
name: fault_no_vector_check
description: >-
  Vulnerable OTA with no vector-table validation before booting a slot.
  After a partial copy corrupts the active image, the bootloader blindly
  jumps to the corrupted vector table. Without checking that the initial SP
  points to SRAM and the reset vector points into the slot, the CPU takes
  a hard fault or executes garbage. Uses the vulnerable copy-in-place
  firmware which performs no vector sanity checks.

platform: platforms/cortex_m0_nvm.repl
bootloader:
  elf: examples/vulnerable_ota/firmware.elf
  entry: 0x10000000

memory:
  sram: { start: 0x20000000, end: 0x20020000 }
  write_granularity: 8
  slots:
    exec:    { base: 0x10000000, size: 0x38000 }
    staging: { base: 0x10038000, size: 0x38000 }

images:
  staging: examples/vulnerable_ota/firmware.bin


success_criteria:
  vtor_in_slot: exec

fault_sweep:
  mode: runtime
  max_writes: 28672
  max_writes_cap: 100000
  run_duration: "0.01"

expect:
  should_find_issues: true
  brick_rate_min: 0.5
